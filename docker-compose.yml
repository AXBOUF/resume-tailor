version: '3.8'

services:
  resume-tailor:
    build: .
    container_name: resume-tailor
    volumes:
      - ./:/app
      - ./output:/app/output
    environment:
      - GROQ_API_KEY=${GROQ_API_KEY}
    working_dir: /app
    command: tail -f /dev/null  # Keep container running
    
  # Service for one-off commands
  tailor:
    build: .
    volumes:
      - ./:/app
      - ./output:/app/output
    environment:
      - GROQ_API_KEY=${GROQ_API_KEY}
    working_dir: /app
    profiles:
      - tools
      
  # LaTeX compilation service only
  latex:
    image: texlive/texlive:latest
    volumes:
      - ./output:/workdir
    working_dir: /workdir
    entrypoint: ["pdflatex"]
    profiles:
      - latex